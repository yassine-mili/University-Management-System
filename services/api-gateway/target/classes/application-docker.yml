spring:
  # Redis Configuration for Docker
  data:
    redis:
      host: redis
      port: 6379
      timeout: 2000ms

  cloud:
    gateway:
      routes:
        - id: auth-service
          uri: http://auth_service:8081
          predicates:
            - Path=/api/auth/**
          filters:
            - StripPrefix=2
            - name: CircuitBreaker
              args:
                name: authService
                fallbackUri: forward:/fallback/auth
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 10
                redis-rate-limiter.burstCapacity: 20
                redis-rate-limiter.requestedTokens: 1

        - id: student-service
          uri: http://student_service:8082
          predicates:
            - Path=/api/students/**
          filters:
            - StripPrefix=2
            - name: CircuitBreaker
              args:
                name: studentService
                fallbackUri: forward:/fallback/student
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 10
                redis-rate-limiter.burstCapacity: 20
                redis-rate-limiter.requestedTokens: 1

        - id: courses-service
          uri: http://courses_service:8083
          predicates:
            - Path=/api/courses/**
          filters:
            - StripPrefix=2
            - name: CircuitBreaker
              args:
                name: coursesService
                fallbackUri: forward:/fallback/courses
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 10
                redis-rate-limiter.burstCapacity: 20
                redis-rate-limiter.requestedTokens: 1

        - id: grades-service
          uri: http://grades_service:8084
          predicates:
            - Path=/api/grades/**
          filters:
            - StripPrefix=2
            - name: CircuitBreaker
              args:
                name: gradesService
                fallbackUri: forward:/fallback/grades
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 10
                redis-rate-limiter.burstCapacity: 20
                redis-rate-limiter.requestedTokens: 1

        - id: billing-service
          uri: http://billing_service:5000
          predicates:
            - Path=/api/billing/**
          filters:
            - StripPrefix=2
            - name: CircuitBreaker
              args:
                name: billingService
                fallbackUri: forward:/fallback/billing
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 5
                redis-rate-limiter.burstCapacity: 10
                redis-rate-limiter.requestedTokens: 1

logging:
  level:
    org.springframework.cloud.gateway: INFO
    com.universite.gateway: INFO
